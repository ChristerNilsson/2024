N = 78 # spelare
ordning = [] # elo-tal fallande

def makeCanvas():
	result = []
	for i in range(N):
		line = ['·'] * N
		line[i] = '*'
		result.append(line)
	return result

def dumpCanvas(title,average,canvas):
	print("")
	print(title)
	print(average)
	header = ' '.join([str((i + 1) % 10) for i in range(N)])
	print('   ' + header)
	for i in range(len(canvas)):
		row = canvas[i]
		nr = i + 1
		if nr < 10:
			nr = ' ' + str(nr)
		else:
			nr = str(nr)
		print(nr, ' '.join([str(item) for item in row]),ordning[i])
	print('   ' + header)

def monrad(title,filename):
	with open(filename,encoding='utf8') as f:
		lines = f.readlines()[6:]

	mat = []
	for line in lines:
		arr = line.split('|')
		ordning.append(arr[0].replace('(',''))
		player = []
		for i in range(2,10):
			ocr = arr[i].replace('(',' ')
			ocr = ocr.replace('b','w')
			arr2 = ocr.split('w')
			player.append(int(arr2[0]))
		mat.append(player)

	canvas = makeCanvas()

	distances = []
	for i in range(len(mat)):
		row = mat[i]
		for j,item in enumerate(row):
			canvas[i][item] = j+1
			distances.append(abs(i-item))

	dumpCanvas(title, sum(distances)/len(distances), canvas)

def swiss(title):

	rounds = []
	players = []
	with open("Swiss-Result.txt",encoding='utf8') as f:
		lines = f.readlines()
		for line in lines:
			elos=[]
			if line.startswith('Round'):
				rounds.append(players)
				players = []
			else:
				arr = line.split('\t')
				for item in arr:
					if len(item)==4: elos.append(ordning.index(item))
			if len(elos)==2:
				players.append(elos)
		rounds.append(players)

	canvas = makeCanvas()

	distances = []
	for i in range(len(rounds)):
		games = rounds[i]
		for [a,b] in games:
			canvas[a][b] = i
			canvas[b][a] = i
			distances.append(abs(a-b))

	dumpCanvas(title,sum(distances)/len(distances),canvas)

def distans(rounds):
	result = []
	for i in range(len(rounds)):
		games = rounds[i]
		for [a,b] in games:
			result.append(abs(a-b))
			# canvas[a][b] = i
			# canvas[b][a] = i
	return sum(result)/len(result)

def macMahon(title,rounds):
	canvas = makeCanvas()
	for i in range(len(rounds)):
		games = rounds[i]
		for [a,b] in games:
			canvas[a][b] = i
			canvas[b][a] = i
	dumpCanvas(title,distans(rounds),canvas)

monrad('Monrad sorterad på Elo',"URL for Tyresö Open_2024 Round 8.txt")
monrad('Monrad sorterad på poäng',"monrad_auto.txt")
macMahon('MacMahon',[[[0, 8], [9, 1], [2, 10], [11, 3], [4, 12], [13, 5], [6, 14], [15, 7], [16, 24], [25, 17], [18, 26], [27, 19], [20, 28], [29, 21], [22, 30], [31, 23], [32, 40], [41, 33], [34, 42], [43, 35], [36, 44], [45, 37], [38, 46], [47, 39], [48, 56], [57, 49], [50, 58], [59, 51], [52, 60], [61, 53], [54, 62], [63, 55], [64, 71], [72, 65], [66, 73], [74, 67], [68, 75], [76, 69], [70, 77]], [[10, 0], [1, 11], [8, 2], [3, 9], [14, 4], [5, 15], [12, 6], [7, 13], [26, 16], [17, 27], [24, 18], [19, 25], [30, 20], [21, 31], [28, 22], [23, 29], [42, 32], [33, 43], [40, 34], [35, 41], [46, 36], [37, 47], [44, 38], [39, 45], [58, 48], [49, 59], [56, 50], [51, 57], [62, 52], [53, 63], [60, 54], [55, 61], [73, 64], [65, 74], [71, 66], [67, 76], [77, 68], [69, 72], [75, 70]], [[0, 12], [13, 1], [2, 14], [15, 3], [4, 8], [9, 5], [6, 10], [11, 7], [16, 28], [29, 17], [18, 30], [31, 19], [20, 24], [25, 21], [22, 26], [27, 23], [32, 44], [45, 33], [34, 46], [47, 35], [36, 40], [41, 37], [38, 42], [43, 39], [48, 60], [61, 49], [50, 62], [63, 51], [52, 56], [57, 53], [54, 58], [59, 55], [64, 75], [76, 65], [66, 77], [72, 67], [68, 71], [74, 69], [70, 73]], [[14, 0], [1, 15], [12, 2], [3, 13], [10, 4], [5, 11], [8, 6], [7, 9], [30, 16], [17, 31], [28, 18], [19, 29], [26, 20], [21, 27], [24, 22], [23, 25], [46, 32], [33, 47], [44, 34], [35, 45], [42, 36], [37, 43], [40, 38], [39, 41], [62, 48], [49, 63], [60, 50], [51, 61], [58, 52], [53, 59], [56, 54], [55, 57], [69, 64], [65, 68], [75, 66], [67, 70], [71, 74], [77, 72], [73, 76]], [[0, 5], [4, 1], [2, 7], [6, 3], [13, 8], [9, 12], [15, 10], [11, 14], [16, 21], [20, 17], [18, 23], [22, 19], [29, 24], [25, 28], [31, 26], [27, 30], [32, 37], [36, 33], [34, 39], [38, 35], [45, 40], [41, 44], [47, 42], [43, 46], [48, 53], [52, 49], [50, 55], [54, 51], [61, 56], [57, 60], [63, 58], [59, 62], [64, 77], [70, 65], [66, 69], [68, 67], [76, 71], [72, 75], [74, 73]], [[7, 0], [1, 6], [5, 2], [3, 4], [8, 15], [14, 9], [10, 13], [12, 11], [23, 16], [17, 22], [21, 18], [19, 20], [24, 31], [30, 25], [26, 29], [28, 27], [39, 32], [33, 38], [37, 34], [35, 36], [40, 47], [46, 41], [42, 45], [44, 43], [55, 48], [49, 54], [53, 50], [51, 52], [56, 63], [62, 57], [58, 61], [60, 59], [67, 64], [65, 66], [73, 68], [69, 70], [71, 72], [77, 74], [75, 76]], [[0, 3], [2, 1], [4, 7], [6, 5], [11, 8], [9, 10], [15, 12], [13, 14], [16, 19], [18, 17], [20, 23], [22, 21], [27, 24], [25, 26], [31, 28], [29, 30], [32, 35], [34, 33], [36, 39], [38, 37], [43, 40], [41, 42], [47, 44], [45, 46], [48, 51], [50, 49], [52, 55], [54, 53], [59, 56], [57, 58], [63, 60], [61, 62], [64, 65], [66, 67], [68, 69], [70, 71], [72, 73], [74, 75], [76, 77]], [[1, 0], [3, 2], [5, 4], [7, 6], [8, 9], [10, 11], [12, 13], [14, 15], [17, 16], [19, 18], [21, 20], [23, 22], [24, 25], [26, 27], [28, 29], [30, 31], [33, 32], [35, 34], [37, 36], [39, 38], [40, 41], [42, 43], [44, 45], [46, 47], [49, 48], [51, 50], [53, 52], [55, 54], [56, 57], [58, 59], [60, 61], [62, 64], [65, 63], [72, 66], [67, 73], [74, 68], [69, 75], [76, 70], [71, 77]]])
macMahon('Swedish Tight',[[[19,18],[50,51],[0,1],[4,5],[12,13],[1,0],[2,3],[28,29],[33,32],[52,53],[3,2],[6,7],[10,11],[15,14],[22,23],[27,26],[35,34],[58,59],[60,61],[5,4],[11,10],[16,17],[24,25],[37,36],[39,38],[41,40],[43,42],[53,52],[59,58],[68,69],[70,71],[7,6],[13,12],[25,24],[34,35],[36,37],[40,41],[44,45],[47,46],[48,49],[51,50],[56,57],[57,56],[63,62],[69,68],[71,70],[77,76],[8,9],[9,8],[14,15],[17,16],[18,19],[20,21],[21,20],[23,22],[26,27],[29,28],[30,31],[31,30],[32,33],[38,39],[42,43],[45,44],[46,47],[49,48],[54,55],[55,54],[61,60],[62,63],[64,65],[65,64],[66,67],[67,66],[72,73],[73,72],[74,75],[75,74],[76,77]],[[19,9],[50,56],[0,3],[4,6],[12,11],[1,72],[2,73],[28,31],[33,34],[52,49],[3,0],[6,4],[10,13],[15,16],[22,21],[27,24],[35,32],[58,54],[60,64],[5,7],[11,12],[16,15],[24,27],[37,45],[39,40],[41,38],[43,47],[53,48],[59,55],[68,71],[70,69],[7,5],[13,10],[25,26],[34,33],[36,44],[40,39],[44,36],[47,43],[48,53],[51,57],[56,50],[57,51],[63,66],[69,70],[71,68],[77,74],[8,18],[9,19],[14,17],[17,14],[18,8],[20,23],[21,22],[23,20],[26,25],[29,30],[30,29],[31,28],[32,35],[38,41],[42,46],[45,37],[46,42],[49,52],[54,58],[55,59],[61,65],[62,67],[64,60],[65,61],[66,63],[67,62],[72,1],[73,2],[74,77],[75,76],[76,75]],[[19,21],[50,47],[0,12],[4,68],[12,0],[1,65],[2,10],[28,66],[33,22],[52,54],[3,11],[6,8],[10,2],[15,40],[22,33],[27,23],[35,42],[58,61],[60,56],[5,9],[11,3],[16,14],[24,53],[37,55],[39,30],[41,31],[43,74],[53,24],[59,57],[68,4],[70,67],[7,13],[13,7],[25,20],[34,36],[36,34],[40,15],[44,49],[47,50],[48,46],[51,45],[56,60],[57,59],[63,64],[69,62],[71,77],[77,71],[8,6],[9,5],[14,16],[17,18],[18,17],[20,25],[21,19],[23,27],[26,29],[29,26],[30,39],[31,41],[32,38],[38,32],[42,35],[45,51],[46,48],[49,44],[54,52],[55,37],[61,58],[62,69],[64,63],[65,1],[66,28],[67,70],[72,75],[73,76],[74,43],[75,72],[76,73]],[[19,36],[50,41],[0,4],[4,0],[12,8],[1,2],[2,1],[28,43],[33,30],[52,63],[3,74],[6,5],[10,17],[15,24],[22,27],[27,22],[35,44],[58,62],[60,57],[5,6],[11,14],[16,21],[24,15],[37,59],[39,45],[41,50],[43,28],[53,66],[59,37],[68,70],[70,68],[7,71],[13,18],[25,23],[34,26],[36,19],[40,46],[44,35],[47,48],[48,47],[51,55],[56,65],[57,60],[63,52],[69,67],[71,7],[77,9],[8,12],[9,77],[14,11],[17,10],[18,13],[20,29],[21,16],[23,25],[26,34],[29,20],[30,33],[31,32],[32,31],[38,42],[42,38],[45,39],[46,40],[49,54],[54,49],[55,51],[61,64],[62,58],[64,61],[65,56],[66,53],[67,69],[72,76],[73,75],[74,3],[75,73],[76,72]],[[19,12],[50,52],[0,16],[4,24],[12,19],[1,28],[2,60],[28,1],[33,27],[52,50],[3,34],[6,74],[10,30],[15,43],[22,13],[27,33],[35,8],[58,48],[60,2],[5,59],[11,36],[16,0],[24,4],[37,46],[39,41],[41,39],[43,15],[53,70],[59,5],[68,63],[70,53],[7,75],[13,22],[25,29],[34,3],[36,11],[40,32],[44,42],[47,45],[48,58],[51,56],[56,51],[57,54],[63,68],[69,65],[71,76],[77,73],[8,35],[9,14],[14,9],[17,20],[18,21],[20,17],[21,18],[23,26],[26,23],[29,25],[30,10],[31,38],[32,40],[38,31],[42,44],[45,47],[46,37],[49,55],[54,57],[55,49],[61,62],[62,61],[64,67],[65,69],[66,72],[67,64],[72,66],[73,77],[74,6],[75,7],[76,71]],[[19,24],[50,53],[0,5],[4,1],[12,15],[1,4],[2,51],[28,11],[33,37],[52,46],[3,10],[6,14],[10,3],[15,12],[22,34],[27,41],[35,43],[58,57],[60,69],[5,0],[11,28],[16,8],[24,19],[37,33],[39,42],[41,27],[43,35],[53,50],[59,68],[68,59],[70,72],[7,9],[13,17],[25,32],[34,22],[36,40],[40,36],[44,38],[47,54],[48,56],[51,2],[56,48],[57,58],[63,65],[69,60],[71,66],[77,75],[8,16],[9,7],[14,6],[17,13],[18,20],[20,18],[21,23],[23,21],[26,30],[29,31],[30,26],[31,29],[32,25],[38,44],[42,39],[45,49],[46,52],[49,45],[54,47],[55,61],[61,55],[62,64],[64,62],[65,63],[66,71],[67,73],[72,70],[73,67],[74,76],[75,77],[76,74]],[[19,4],[50,33],[0,15],[4,19],[12,35],[1,11],[2,24],[28,37],[33,50],[52,59],[3,53],[6,70],[10,25],[15,0],[22,40],[27,34],[35,12],[58,51],[60,77],[5,16],[11,1],[16,5],[24,2],[37,28],[39,46],[41,43],[43,41],[53,3],[59,52],[68,72],[70,6],[7,76],[13,8],[25,10],[34,27],[36,32],[40,22],[44,54],[47,56],[48,63],[51,58],[56,47],[57,61],[63,48],[69,75],[71,67],[77,60],[8,13],[9,17],[14,18],[17,9],[18,14],[20,26],[21,30],[23,29],[26,20],[29,23],[30,21],[31,42],[32,36],[38,49],[42,31],[45,55],[46,39],[49,38],[54,44],[55,45],[61,57],[62,65],[64,66],[65,62],[66,64],[67,71],[72,68],[73,74],[74,73],[75,69],[76,7]],[[19,50],[50,19],[0,2],[4,12],[12,4],[1,33],[2,0],[28,52],[33,1],[52,28],[3,6],[6,3],[10,15],[15,10],[22,35],[27,58],[35,22],[58,27],[60,5],[5,60],[11,16],[16,11],[24,37],[37,24],[39,43],[41,53],[43,39],[53,41],[59,70],[68,7],[70,59],[7,68],[13,25],[25,13],[34,40],[36,47],[40,34],[44,48],[47,36],[48,44],[51,63],[56,69],[57,71],[63,51],[69,56],[71,57],[77,8],[8,77],[9,18],[14,20],[17,21],[18,9],[20,14],[21,17],[23,30],[26,31],[29,32],[30,23],[31,26],[32,29],[38,45],[42,49],[45,38],[46,54],[49,42],[54,46],[55,62],[61,66],[62,55],[64,73],[65,75],[66,61],[67,76],[72,74],[73,64],[74,72],[75,65],[76,67]]])

swiss('Swiss sorterad på poäng. Verkliga partier, Tyresö Open 2024')